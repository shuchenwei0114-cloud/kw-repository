<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WDR 2024 | WDR Repository</title>
    <style>
      :root {
        --bg: #ffffff;
        --card: #ffffff;
        --ring: #d7e0e8;
        --text: #1d2f42;
        --muted: #667785;
        --creation: #050505;
        --preservation: #f86124;
        --destruction: #263754;
        --circle-size: 20%;
        --circle-preservation-size: 24%;
        --circle-destruction-size: 17%;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        background: var(--bg);
        font-family: "Avenir Next", "Segoe UI", sans-serif;
        color: var(--text);
      }

      .back-link {
        position: fixed;
        top: 14px;
        left: 14px;
        z-index: 30;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 12px;
        border-radius: 999px;
        border: 1px solid #c8d4df;
        background: rgba(255, 255, 255, 0.94);
        color: #20344a;
        font-size: 0.85rem;
        font-weight: 700;
        text-decoration: none;
        transition: background-color 180ms ease, border-color 180ms ease;
      }

      .back-link:hover {
        background: #f1f6fb;
        border-color: #9eb6c8;
      }

      main {
        min-height: 100vh;
        padding: 22px 0 40px;
      }

      .page-shell {
        width: min(1180px, 92vw);
        margin: 0 auto;
      }

      .panel {
        border: 1px solid var(--ring);
        background: var(--card);
        border-radius: 14px;
      }

      .core-panel {
        padding: 18px;
      }

      .core-hero {
        border: 0;
        background: transparent;
        padding: 30px 10px 8px;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 14px;
      }

      .core-note {
        margin: 0;
        color: var(--muted);
        font-size: 1.18rem;
        line-height: 1.42;
        max-width: 980px;
      }

      .panel-title {
        margin: 0 0 12px;
        font-size: 1rem;
        text-transform: uppercase;
        letter-spacing: 0.06em;
      }

      .panel-grid {
        margin-top: 14px;
        display: grid;
        gap: 12px;
        grid-template-columns: 1fr;
      }

      .sub-panel {
        min-height: 138px;
        padding: 14px;
      }

      .sub-panel--wide {
        grid-column: 1 / -1;
      }

      .split-panel {
        display: grid;
        grid-template-columns: minmax(0, 1fr) minmax(0, 1fr);
        gap: 14px;
        align-items: stretch;
      }

      .split-left {
        min-height: 220px;
      }

      .split-right {
        min-height: 220px;
      }

      .transition-steps {
        margin: 0;
        color: #20344a;
        font-size: 1rem;
        font-weight: 700;
        letter-spacing: 0.01em;
      }

      .center-statement {
        margin: 0;
        color: #2a3f55;
        font-size: 1.18rem;
        line-height: 1.42;
        text-align: center;
        max-width: 980px;
      }

      .trap-hero {
        border: 0;
        background: transparent;
        padding: 10px 10px;
        display: flex;
        justify-content: center;
      }

      .stats-list {
        margin: 12px 0 0;
        padding-left: 20px;
        color: var(--muted);
        font-size: 0.95rem;
        line-height: 1.5;
      }

      .stats-list li + li {
        margin-top: 6px;
      }

      .metric-pop {
        color: #ff7a00;
      }

      .metric-gdp {
        color: #8e44ad;
      }

      .metric-poverty {
        color: #16a34a;
      }

      .metric-co2 {
        color: #e11d48;
      }

      .first-panel-layout {
        display: grid;
        grid-template-columns: minmax(300px, 1fr) minmax(460px, 1.1fr);
        gap: 14px;
        align-items: stretch;
      }

      .share-wrap {
        padding: 4px 6px;
        max-width: 560px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        height: 100%;
      }

      .share-title {
        margin: 0 0 8px;
        text-align: center;
        color: #2c4373;
        font-size: 0.92rem;
        font-weight: 500;
      }

      .pie-grid {
        display: grid;
        grid-template-columns: repeat(4, minmax(96px, 1fr));
        gap: 10px;
      }

      .pie-item {
        text-align: center;
      }

      .pie {
        width: 90px;
        height: 90px;
        margin: 0 auto 6px;
        border-radius: 50%;
        border: 2px solid #f1f4f8;
        box-shadow: inset 0 0 0 1px rgba(20, 30, 50, 0.06);
      }

      .pie-label {
        margin: 0;
        color: #1d2430;
        font-size: 0.62rem;
        font-weight: 500;
        line-height: 1.2;
        white-space: nowrap;
      }

      .share-legend {
        margin-top: 10px;
        display: flex;
        justify-content: center;
        gap: 14px;
        flex-wrap: wrap;
      }

      .share-key {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        color: #2f4777;
        font-size: 0.74rem;
        font-weight: 500;
      }

      .share-swatch {
        width: 13px;
        height: 13px;
      }

      .growth-chart-panel {
        padding: 16px;
      }

      .growth-chart-svg {
        width: 100%;
        height: auto;
        display: block;
      }

      .growth-chart-inline-title {
        margin: 0 0 10px;
        color: #23242a;
        font-size: 1.02rem;
        line-height: 1.25;
        font-weight: 700;
      }

      .growth-slot {
        min-height: 460px;
        display: none;
      }

      .growth-slot.is-visible {
        display: block;
      }

      .trigger-item {
        cursor: pointer;
      }

      .axis-label {
        fill: #2c2e34;
        font-size: 13px;
        font-weight: 600;
      }

      .axis-tick {
        fill: #2c2e34;
        font-size: 11px;
      }

      .grid-line {
        stroke: #d6d6da;
        stroke-width: 1;
      }

      .axis-line {
        stroke: #2f3238;
        stroke-width: 1.2;
      }

      .series-line {
        fill: none;
        stroke-width: 3.2;
        stroke-linecap: round;
        stroke-linejoin: round;
      }

      .chart-legend {
        margin-top: 10px;
        display: grid;
        gap: 6px 10px;
        grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
        font-size: 0.78rem;
      }

      .legend-item {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        color: #2b3440;
      }

      .legend-swatch {
        width: 16px;
        height: 0;
        border-top: 3px solid;
        border-radius: 999px;
      }

      .growth-insight-panel .split-panel {
        grid-template-columns: minmax(260px, 0.8fr) minmax(560px, 1.4fr);
      }

      .series-line,
      .legend-item {
        transition: opacity 220ms ease, filter 220ms ease;
      }

      .series-line.is-dim,
      .legend-item.is-dim {
        opacity: 0.2;
        filter: saturate(0.6);
      }

      .series-line.is-active,
      .legend-item.is-active {
        opacity: 1;
        filter: saturate(1);
      }

      .sub-panel--transition {
        grid-column: 1 / -1;
        min-height: auto;
        padding: 10px;
        overflow: hidden;
      }

      .transition-layout {
        margin-top: 6px;
        display: grid;
        gap: 0;
        grid-template-columns: minmax(340px, 1fr) minmax(520px, 10.5fr);
        align-items: center;
      }

      .transition-text {
        min-height: 200px;
        padding: 12px;
        color: var(--muted);
        font-size: 0.9rem;
        line-height: 1.4;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
        gap: 10px;
      }

      .transition-point {
        margin: 0;
        color: #445666;
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.38;
      }

      .transition-point strong {
        color: #263754;
        font-weight: 800;
      }

      .sub-panel h3 {
        margin: 0;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.04em;
        white-space: nowrap;
      }

      .sub-panel p {
        margin: 9px 0 0;
        color: var(--muted);
        font-size: 0.86rem;
        line-height: 1.35;
      }

      .diagram-wrap {
        width: 100%;
        margin: 0;
        overflow: visible;
      }

      .cp-zone {
        padding-left: 0;
      }

      .diagram-board {
        position: relative;
        width: 100%;
        aspect-ratio: 900 / 400;
        min-height: 235px;
        overflow: visible;
      }

      .circle {
        position: absolute;
        top: 50%;
        left: 50%;
        border: 0;
        border-radius: 50%;
        color: #ffffff;
        font-weight: 700;
        letter-spacing: 0.02em;
        text-transform: uppercase;
        display: grid;
        place-items: center;
        text-align: center;
        cursor: pointer;
        box-shadow: 0 8px 20px rgba(17, 34, 52, 0.22);
        transition: box-shadow 240ms ease, filter 240ms ease, opacity 240ms ease;
        width: var(--circle-size);
        aspect-ratio: 1 / 1;
        transform: translate(-50%, -50%) scale(1);
        z-index: 2;
      }

      .diagram-board.has-focus .circle {
        filter: saturate(0.55) contrast(0.86) brightness(0.9);
        opacity: 0.72;
      }

      .diagram-board.has-focus .circle.is-focus {
        box-shadow: 0 14px 28px rgba(17, 34, 52, 0.32);
        filter: saturate(1) contrast(1) brightness(1);
        opacity: 1;
        z-index: 4;
      }

      .circle:focus-visible {
        outline: 2px solid #3c74a6;
        outline-offset: 3px;
      }

      .circle--creation {
        top: 21%;
        left: 40%;
        background: var(--creation);
      }

      .circle--preservation {
        top: 64%;
        left: 60%;
        width: var(--circle-preservation-size);
        background: var(--preservation);
      }

      .circle--destruction {
        top: 64%;
        left: 26%;
        width: var(--circle-destruction-size);
        background: var(--destruction);
      }

      .circle-label {
        width: 92%;
        font-size: clamp(7px, 0.72vw, 10px);
        line-height: 1.05;
        letter-spacing: 0;
        white-space: normal;
        overflow-wrap: anywhere;
        text-align: center;
      }

      .circle--preservation .circle-label {
        width: 82%;
        font-size: clamp(8px, 0.82vw, 11px);
        white-space: nowrap;
        overflow: visible;
      }

      @media (max-width: 760px) {
        :root {
          --circle-size: 21%;
          --circle-preservation-size: 25%;
          --circle-destruction-size: 18%;
        }

        .diagram-wrap {
          width: 100%;
        }

        .transition-layout {
          grid-template-columns: 1fr;
        }

        .transition-text {
          min-height: 110px;
        }

        .cp-zone {
          padding-left: 0;
        }

        .panel-grid {
          grid-template-columns: 1fr;
        }

        .split-panel {
          grid-template-columns: 1fr;
        }

        .first-panel-layout {
          grid-template-columns: 1fr;
        }

        .pie-grid {
          grid-template-columns: repeat(2, minmax(120px, 1fr));
        }

        .sub-panel--transition {
          grid-column: auto;
        }
      }
    </style>
  </head>
  <body>
    <a class="back-link" href="index.html" aria-label="Back to main page">&larr; Back</a>
    <main>
      <section class="page-shell">
        <article class="core-panel core-hero">
          <p class="core-note">To escape middle income trap, countries must engineer two successive transitions &mdash; from investment to infusion, and from infusion to innovation. Success depends on how well they balance creation, destruction, and preservation &mdash; using capital, talent, and energy more efficiently than ever before.</p>
        </article>

        <section class="panel-grid" aria-label="WDR 2024 framework panels">
          <article class="panel sub-panel sub-panel--wide">
            <div class="first-panel-layout">
              <section>
                <h3>Today's 108 middle-income countries</h3>
                <ul class="stats-list">
                  <li>Represent about <strong class="metric-gdp">40%</strong> of global output</li>
                  <li>House roughly <strong class="metric-pop">75%</strong> of the world&rsquo;s population</li>
                  <li>Account for more than <strong class="metric-poverty">60%</strong> of global poverty</li>
                  <li>Produce nearly <strong class="metric-co2">2/3</strong> of global carbon dioxide emissions</li>
                </ul>
              </section>
              <section class="share-wrap" aria-label="Share pies by income group">
                <p class="share-title">Share of</p>
                <div class="pie-grid">
                  <article class="pie-item">
                    <div class="pie" style="background: conic-gradient(rgba(76,159,211,0.45) 0deg 32deg, #ff7a00 32deg 303deg, rgba(13,86,129,0.45) 303deg 360deg);"></div>
                    <p class="pie-label">Population</p>
                  </article>
                  <article class="pie-item">
                    <div class="pie" style="background: conic-gradient(rgba(76,159,211,0.45) 0deg 2deg, #8e44ad 2deg 141deg, rgba(13,86,129,0.45) 141deg 360deg);"></div>
                    <p class="pie-label">GDP</p>
                  </article>
                  <article class="pie-item">
                    <div class="pie" style="background: conic-gradient(rgba(76,159,211,0.45) 0deg 131deg, #16a34a 131deg 356deg, rgba(13,86,129,0.45) 356deg 360deg);"></div>
                    <p class="pie-label">Population in extreme poverty</p>
                  </article>
                  <article class="pie-item">
                    <div class="pie" style="background: conic-gradient(rgba(76,159,211,0.45) 0deg 1deg, #e11d48 1deg 240deg, rgba(13,86,129,0.45) 240deg 360deg);"></div>
                    <p class="pie-label">COâ‚‚ Emissions</p>
                  </article>
                </div>
                <div class="share-legend">
                  <span class="share-key"><span class="share-swatch" style="background:rgba(76,159,211,0.45)"></span>Low income</span>
                  <span class="share-key"><span class="share-swatch" style="background:linear-gradient(90deg, #ff7a00 0%, #8e44ad 35%, #16a34a 70%, #e11d48 100%)"></span>Middle income</span>
                  <span class="share-key"><span class="share-swatch" style="background:rgba(13,86,129,0.45)"></span>High income</span>
                </div>
              </section>
            </div>
          </article>
          <article class="sub-panel sub-panel--wide trap-hero">
            <p class="center-statement">Middle-income countries are prone to systematic growth slowdowns&mdash;a concept termed the <strong>Middle-Income Trap</strong>.</p>
          </article>
          <article class="panel sub-panel sub-panel--wide growth-insight-panel">
            <h3>Middle-Income Countries Are Experiencing:</h3>
            <div class="split-panel">
              <section class="split-left">
                <ul class="stats-list">
                  <li class="trigger-item" id="slower-growth-trigger"><strong>Slower Growth</strong>.</li>
                  <li><strong>Structural Stasis</strong>.</li>
                  <li>Shrinking Spaces</li>
                </ul>
              </section>
              <section class="split-right growth-chart-panel">
                <div class="growth-slot" id="growth-slot">
                  <p class="growth-chart-inline-title">Growth is expected to slow down as countries approach the economic frontier(United States)</p>
                  <svg class="growth-chart-svg" id="growth-chart" viewBox="0 0 1100 560" role="img" aria-label="Animated growth slowdown line chart"></svg>
                  <div class="chart-legend" id="growth-chart-legend" aria-label="Chart legend"></div>
                </div>
              </section>
            </div>
          </article>
          <article class="panel sub-panel sub-panel--wide">
            <p class="transition-steps">1i: Investment &rarr; 2i: Investment + infusion &rarr; 3i: Investment + infusion + Innovation</p>
          </article>
          <article class="panel sub-panel sub-panel--transition">
            <h3>Transition Model</h3>
            <div class="transition-layout">
              <div class="transition-text" id="transition-text">
                <p class="transition-point">Middle-income countries are hampered by an imbalance among the forces of creation, preservation, and destruction. The forces of creation are weak, the forces of preservation are strong, and destruction is held back by the forces of preservation.</p>
              </div>
              <section class="diagram-wrap cp-zone" aria-label="Creation preservation destruction diagram">
                <div class="diagram-board" role="img" aria-label="Three-force loop with interactive circles: creation, preservation, and destruction">
                  <button type="button" class="circle circle--creation" data-force="creation">
                    <span class="circle-label">Creation</span>
                  </button>

                  <button type="button" class="circle circle--preservation" data-force="preservation">
                    <span class="circle-label">Preservation</span>
                  </button>

                  <button type="button" class="circle circle--destruction" data-force="destruction">
                    <span class="circle-label">Destruction</span>
                  </button>
                </div>
              </section>
            </div>
          </article>
        </section>
      </section>
    </main>

    <script>
      const board = document.querySelector('.diagram-board');
      const circles = document.querySelectorAll('.circle');
      const transitionText = document.querySelector('#transition-text');
      const defaultTransitionHTML = transitionText.innerHTML;
      const creationHoverHTML = `
        <p class="transition-point">
          Creation is weak: Both incumbents and entrants can create value, but in many middle-income countries, large incumbents are slow to infuse or innovate, too few new entrants create or disrupt.
        </p>
      `;
      const preservationHoverHTML = `
        <p class="transition-point">
          Preservation is the strongest: In many middle-income countries, incumbents and elites use market power, policy influence, and social networks to preserve the status quo, limiting competition, restricting social mobility, and protecting outdated arrangements.
        </p>
      `;
      const disruptionHoverHTML = `
        <p class="transition-point">
          Disruption is kept weak: Destruction is necessary to clear the way for creation by freeing up misallocated resources, but in many middle-income countries it is held back by preservation forces.
        </p>
      `;

      const applyFocus = (targetCircle) => {
        board.classList.add('has-focus');
        circles.forEach((el) => el.classList.remove('is-focus'));
        if (targetCircle) targetCircle.classList.add('is-focus');

        if (targetCircle?.dataset.force === 'creation') {
          transitionText.innerHTML = creationHoverHTML;
        } else if (targetCircle?.dataset.force === 'preservation') {
          transitionText.innerHTML = preservationHoverHTML;
        } else if (targetCircle?.dataset.force === 'destruction') {
          transitionText.innerHTML = disruptionHoverHTML;
        } else {
          transitionText.innerHTML = defaultTransitionHTML;
        }
      };

      const clearFocus = () => {
        board.classList.remove('has-focus');
        circles.forEach((el) => el.classList.remove('is-focus'));
        transitionText.innerHTML = defaultTransitionHTML;
      };

      circles.forEach((circle) => {
        circle.addEventListener('mouseenter', () => {
          applyFocus(circle);
        });
        circle.addEventListener('mouseleave', () => {
          clearFocus();
        });
        circle.addEventListener('focus', () => {
          applyFocus(circle);
        });
        circle.addEventListener('blur', clearFocus);
      });

      board.addEventListener('mousemove', (event) => {
        if (!event.target.closest('.circle')) clearFocus();
      });
      board.addEventListener('mouseleave', clearFocus);

      const chartSvg = document.querySelector('#growth-chart');
      const chartLegend = document.querySelector('#growth-chart-legend');
      const growthSlot = document.querySelector('#growth-slot');
      const slowerGrowthTrigger = document.querySelector('#slower-growth-trigger');

      const growthSeries = [
        { name: 'Bangladesh', color: '#7f9336', points: [[3, 6.5], [4, 5.3], [6, 4.3], [8, 3.6], [9.5, 3.25], [11, 3.15], [13, 3.25], [16, 3.12], [20, 3.03]] },
        { name: 'China', color: '#eb6426', points: [[20, 5.2], [21, 5.05], [22, 4.2], [24, 3.8], [26, 3.0], [30, 2.8], [32, 2.4], [34, 2.95], [37, 3.05], [40, 2.9], [45, 2.35], [47.5, 2.2], [50.5, 3.0], [56, 3.0], [63, 2.9]] },
        { name: 'India', color: '#bf7d24', points: [[4.2, 5.35], [5.8, 4.6], [7.4, 4.2], [9.6, 3.95], [11.8, 3.75], [13.8, 3.75], [17.6, 3.85], [21.8, 3.82], [26, 3.8]] },
        { name: 'Indonesia', color: '#5c6898', points: [[7, 4.35], [8.5, 3.95], [10, 3.55], [12, 3.4], [16, 3.24], [20, 3.03], [24, 3.05], [29, 3.02]] },
        { name: 'Poland', color: '#31a09b', points: [[26.5, 5.35], [29, 4.65], [31, 4.45], [33, 4.45], [36, 4.2], [39, 3.95], [43, 3.45], [47, 3.05], [52, 3.1], [60, 3.5], [69, 3.78], [74, 3.76], [79, 3.58], [86, 3.62], [90, 3.56], [94, 3.35], [98, 3.38], [100, 3.36]] },
        { name: 'Turkiye', color: '#9a9a9a', points: [[22.6, 2.65], [24.2, 2.35], [25.3, 2.08], [26.2, 1.78], [27.4, 1.86], [28.6, 1.92], [29.5, 1.76], [30, 1.52], [31.5, 1.7], [32, 1.72]] }
      ];

      const drawGrowthChart = () => {
        if (!chartSvg || !chartLegend) return;

        chartSvg.innerHTML = '';
        chartLegend.innerHTML = '';

        const width = 1100;
        const height = 560;
        const margin = { top: 30, right: 40, bottom: 90, left: 72 };
        const innerW = width - margin.left - margin.right;
        const innerH = height - margin.top - margin.bottom;

        const xScale = (x) => margin.left + (x / 100) * innerW;
        const yScale = (y) => margin.top + ((7 - y) / 7) * innerH;

        for (let y = 0; y <= 7; y += 1) {
          const yPx = yScale(y);
          const grid = document.createElementNS('http://www.w3.org/2000/svg', 'line');
          grid.setAttribute('x1', margin.left);
          grid.setAttribute('x2', width - margin.right);
          grid.setAttribute('y1', yPx);
          grid.setAttribute('y2', yPx);
          grid.setAttribute('class', 'grid-line');
          chartSvg.appendChild(grid);

          const tick = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          tick.setAttribute('x', margin.left - 14);
          tick.setAttribute('y', yPx + 4);
          tick.setAttribute('text-anchor', 'end');
          tick.setAttribute('class', 'axis-tick');
          tick.textContent = y === 0 ? '' : String(y);
          chartSvg.appendChild(tick);
        }

        for (let x = 0; x <= 100; x += 10) {
          const xPx = xScale(x);
          const tick = document.createElementNS('http://www.w3.org/2000/svg', 'text');
          tick.setAttribute('x', xPx);
          tick.setAttribute('y', height - margin.bottom + 24);
          tick.setAttribute('text-anchor', 'middle');
          tick.setAttribute('class', 'axis-tick');
          tick.textContent = String(x);
          chartSvg.appendChild(tick);
        }

        const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        xAxis.setAttribute('x1', margin.left);
        xAxis.setAttribute('x2', width - margin.right);
        xAxis.setAttribute('y1', height - margin.bottom);
        xAxis.setAttribute('y2', height - margin.bottom);
        xAxis.setAttribute('class', 'axis-line');
        chartSvg.appendChild(xAxis);

        const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        yAxis.setAttribute('x1', margin.left);
        yAxis.setAttribute('x2', margin.left);
        yAxis.setAttribute('y1', margin.top);
        yAxis.setAttribute('y2', height - margin.bottom);
        yAxis.setAttribute('class', 'axis-line');
        chartSvg.appendChild(yAxis);

        const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        xLabel.setAttribute('x', margin.left + innerW / 2);
        xLabel.setAttribute('y', height - 18);
        xLabel.setAttribute('text-anchor', 'middle');
        xLabel.setAttribute('class', 'axis-label');
        xLabel.textContent = 'GDP per capita relative to the frontier (United States) (%)';
        chartSvg.appendChild(xLabel);

        const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
        yLabel.setAttribute('transform', `translate(18 ${margin.top + innerH / 2}) rotate(-90)`);
        yLabel.setAttribute('text-anchor', 'middle');
        yLabel.setAttribute('class', 'axis-label');
        yLabel.textContent = 'Annual growth in GDP per capita (%)';
        chartSvg.appendChild(yLabel);

        growthSeries.forEach((series, idx) => {
          const d = series.points
            .map((point, i) => `${i === 0 ? 'M' : 'L'} ${xScale(point[0]).toFixed(2)} ${yScale(point[1]).toFixed(2)}`)
            .join(' ');

          const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
          path.setAttribute('d', d);
          path.setAttribute('class', 'series-line');
          path.setAttribute('stroke', series.color);
          path.dataset.series = series.name;
          chartSvg.appendChild(path);

          const length = path.getTotalLength();
          path.style.strokeDasharray = `${length}`;
          path.style.strokeDashoffset = `${length}`;
          path.style.animation = `draw-series 3.2s ease ${idx * 0.25}s forwards`;

          const legendItem = document.createElement('div');
          legendItem.className = 'legend-item';
          legendItem.dataset.series = series.name;
          legendItem.innerHTML = `<span class="legend-swatch" style="border-top-color:${series.color}"></span><span>${series.name}</span>`;
          chartLegend.appendChild(legendItem);
        });

        const setSeriesFocus = (seriesName) => {
          chartSvg.querySelectorAll('.series-line').forEach((lineEl) => {
            const active = lineEl.dataset.series === seriesName;
            lineEl.classList.toggle('is-active', active);
            lineEl.classList.toggle('is-dim', !active);
          });
          chartLegend.querySelectorAll('.legend-item').forEach((itemEl) => {
            const active = itemEl.dataset.series === seriesName;
            itemEl.classList.toggle('is-active', active);
            itemEl.classList.toggle('is-dim', !active);
          });
        };

        const clearSeriesFocus = () => {
          chartSvg.querySelectorAll('.series-line').forEach((lineEl) => {
            lineEl.classList.remove('is-active', 'is-dim');
          });
          chartLegend.querySelectorAll('.legend-item').forEach((itemEl) => {
            itemEl.classList.remove('is-active', 'is-dim');
          });
        };

        chartSvg.querySelectorAll('.series-line').forEach((lineEl) => {
          lineEl.addEventListener('mouseenter', () => setSeriesFocus(lineEl.dataset.series));
          lineEl.addEventListener('mouseleave', clearSeriesFocus);
        });

        chartLegend.querySelectorAll('.legend-item').forEach((itemEl) => {
          itemEl.addEventListener('mouseenter', () => setSeriesFocus(itemEl.dataset.series));
          itemEl.addEventListener('mouseleave', clearSeriesFocus);
        });
      };

      const styleTag = document.createElement('style');
      styleTag.textContent = `@keyframes draw-series { to { stroke-dashoffset: 0; } }`;
      document.head.appendChild(styleTag);

      if (slowerGrowthTrigger && growthSlot) {
        slowerGrowthTrigger.addEventListener('mouseenter', () => {
          growthSlot.classList.add('is-visible');
          drawGrowthChart();
        });
        slowerGrowthTrigger.addEventListener('mouseleave', () => {
          growthSlot.classList.remove('is-visible');
        });
      }
    </script>
  </body>
</html>
